<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Radar</title>
    <meta name="description" content="Приложение для уведомлений о преступности и безопасности" />
    <meta name="author" content="RADAR Team" />

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="icon" type="image/svg+xml" sizes="32x32" href="/app-icon.svg">
    <link rel="icon" type="image/svg+xml" sizes="16x16" href="/favicon.svg">
    <link rel="apple-touch-icon" sizes="180x180" href="/app-icon.svg">

    <meta property="og:title" content="Radar" />
    <meta property="og:description" content="Community-driven safety platform for real-time incident reporting and alerts" />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="/app-icon.svg" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@radar_safety" />
    <meta name="twitter:image" content="/app-icon.svg" />
    
    <!-- PWA мета-теги -->
    <meta name="theme-color" content="#191E22">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Radar">
    
    <!-- Manifest -->
    <link rel="manifest" href="/manifest.json">
    <script type="module" crossorigin src="/assets/index-CZYVfY9K.js"></script>
    <link rel="modulepreload" crossorigin href="/assets/vendor-CYUu28OS.js">
    <link rel="stylesheet" crossorigin href="/assets/index-CTPFdTh0.css">
  </head>

  <body style="background-color: #191E22; color: white; font-family: Arial, sans-serif;">
    <div id="root"></div>
    <!-- Глобальный отладочный скрипт (будет удалён в релизе) -->
    <script>
      // Полифилл crypto.randomUUID для старых WebView
      (function () {
        if (typeof crypto !== 'undefined' && typeof crypto.randomUUID !== 'function') {
          crypto.randomUUID = function () {
            const arr = new Uint8Array(16);
            if (typeof crypto.getRandomValues === 'function') {
              crypto.getRandomValues(arr);
            } else {
              // Фолбэк: Math.random (менее надёжно, но допустимо для идентификатора)
              for (let i = 0; i < 16; i++) arr[i] = Math.random() * 256;
            }
            arr[6] = (arr[6] & 0x0f) | 0x40;
            arr[8] = (arr[8] & 0x3f) | 0x80;
            const toHex = (b) => b.toString(16).padStart(2, '0');
            return (
              toHex(arr[0]) + toHex(arr[1]) + toHex(arr[2]) + toHex(arr[3]) + '-' +
              toHex(arr[4]) + toHex(arr[5]) + '-' +
              toHex(arr[6]) + toHex(arr[7]) + '-' +
              toHex(arr[8]) + toHex(arr[9]) + '-' +
              toHex(arr[10]) + toHex(arr[11]) + toHex(arr[12]) + toHex(arr[13]) + toHex(arr[14]) + toHex(arr[15])
            );
          };
        }
      })();

      // Выводим все необработанные ошибки прямо на экран
      const showError = (msg) => {
        const pre = document.createElement('pre');
        pre.style.cssText = 'background:#300;color:#fff;padding:10px;font-size:12px;white-space:pre-wrap;text-align:left;';
        pre.textContent = '[Radar Error]\n' + msg;
        document.body.appendChild(pre);
      };

      window.onerror = function (msg, src, line, col, err) {
        const stack = err && err.stack ? err.stack : msg;
        showError(stack);
        console.log('GLOBAL ERROR', msg, src, line, col, err);
      };
      window.addEventListener('unhandledrejection', function (e) {
        const reason = e.reason && e.reason.stack ? e.reason.stack : e.reason;
        showError('UnhandledPromise: ' + reason);
        console.log('PROMISE ERROR', e.reason);
      });
    </script>
  </body>
</html>
